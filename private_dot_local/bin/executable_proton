#!/bin/bash
# shellcheck disable=SC2155

err() {
	echo -e "\e[31;1m$*\e[0m" >&2
}

if (($# == 0)); then
	echo "Usage: PREFIX=/path/to/wineprefix $(basename "$0") PROGRAM [ARGUMENTS...]"
	exit
fi

if [[ -z "$PREFIX" ]]; then
	err "proton PREFIX not defined"
	exit
fi

export STEAM_COMPAT_CLIENT_INSTALL_PATH=~/.local/share/Steam
export STEAM_COMPAT_DATA_PATH=$(readlink -f "$PREFIX")
_PROTON_BIN="$STEAM_COMPAT_CLIENT_INSTALL_PATH/steamapps/common/Proton 7.0/proton"

exec "$_PROTON_BIN" run "$*"
